# 博客文章后台编辑与发布需求文档

## 1. 需求概述
为博客后台提供一套完整的文章创建、Markdown 编辑、实时预览及发布功能。  
核心编辑器采用开源项目 [Vditor](https://github.com/Vanessa219/vditor)，支持所见即所得、即时渲染、分屏预览三种模式，并兼容 CommonMark / GFM 规范。

---

## 2. 功能清单
| 模块 | 功能点 | 描述 |
|----|------|------|
| ① 文章创建 | 新建草稿 | 点击「新建文章」自动生成草稿，唯一 ID、创建时间、作者信息入库 |
| ② 编辑器 | Markdown 输入 | 基于 Vditor，默认开启「即时渲染」模式 |
| ③ 编辑器 | 模式切换 | 提供「所见即所得」「即时渲染」「分屏预览」三种模式快捷切换 |
| ④ 编辑器 | 快捷键 | 支持 Ctrl+S 保存、Ctrl+Z 撤销、Ctrl+Shift+Z 重做、F9 切换全屏 |
| ⑤ 编辑器 | 粘贴优化 | 粘贴 HTML 自动转 Markdown；粘贴图片自动上传图床并插入链接 |
| ⑥ 预览 | 实时同步 | 右侧预览区与左侧编辑区同步滚动，延迟 ≤ 200 ms |
| ⑦ 元数据 | 文章属性 | 标题、别名(slug)、摘要、封面图、分类、标签、状态（草稿/发布） |
| ⑧ 自动保存 | 本地快照 | 每 30 s 将编辑器内容写入 localStorage，异常刷新后提示恢复 |
| ⑨ 远程保存 | 手动保存 | 点击「保存」或 Ctrl+S 调用 POST /api/admin/article/save 接口 |
| ⑩ 发布 | 一键发布 | 点击「发布」调用 POST /api/admin/article/publish，生成静态 HTML 并刷新 CDN |
| ⑪ 撤回 | 取消发布 | 已发布文章可「撤回」，状态变为草稿，CDN 缓存失效 |
| ⑫ 历史版本 | 版本对比 | 每次保存生成版本号，支持查看 diff 与一键回滚 |
| ⑬ 导入 | Markdown 文件 | 支持 .md 文件上传，自动解析 Front-matter 填充元数据 |
| ⑭ 导出 | 多格式 | 支持导出 Markdown、PDF、HTML（含主题样式） |
| ⑮ 图床 | 自动上传 | 支持 OSS/S3/MinIO，可配置前缀与水印 |

---

## 3. 接口约定
| Method | Path | 描述 | 主要字段 |
|--------|------|------|----------|
| POST | /api/admin/article/save | 保存草稿 | id, title, content, meta{…} |
| POST | /api/admin/article/publish | 发布 | id, publishTime |
| POST | /api/admin/article/withdraw | 撤回 | id |
| GET | /api/admin/article/{id}/versions | 历史版本 | page, size |
| POST | /api/admin/article/rollback | 回滚 | id, version |

---

## 4. 前端实现要点
1. 引入 Vditor CDN 或 npm 包  
   `npm i vditor --save`
2. 初始化配置

## UI设计

- 参考: UI目录/后台/文章发布页